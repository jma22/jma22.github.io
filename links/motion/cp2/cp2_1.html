<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="../../links.css">
</head>

<body>
<h1>Checkpoint 2: Other graph convs!</h1>

<p><a href = "../../motion/cp1.html">Run down of graph convs  </a> </p> 


<p>GraphConv: As explained before, graph conv</p>


<h2>Testing:</h2>
<p>Specs:</p>
<ul>
  <li>Layers: 3-32-32-32-3 </li>
  <li>Activation: Leaky relu </li>
  <li>Loss: MSE + MAE</li>
  <b><li>SAGEm: SAGEconv with mean aggregation</li></b>
  <b><li>SAGEl: SAGEconv with LSTM aggregation</li></b>
  <b><li>SAGEg: SAGEconv with GCN aggregation</li></b>
  <b><li>Edge: Edgeconv</li></b>
  <b><li>Attention: Graph attention network, 1-head</li></b>
</ul>
<center>
    <img src = "../../../media/motion/phase1/CP2/typeloss.png" width="550px" height="350px"></img> 
    <p>Loss</p>
</center>
<hr>
<center>
    <img src = "../../../media/motion/phase1/CP2/typeloss2.png" width="550px" height="350px"></img> 
    <p>Closer look at loss</p>
</center>
<hr>
<h3>SAGEConv</h3>
<center>
    <img src = "../../../media/motion/phase1/CP2/sagem.png" width="850px" height="350px"></img> 
    <p>SAGEm loss: 0.004168 </p>
</center>
<hr>
<center>
    <img src = "../../../media/motion/phase1/CP2/sageg.png" width="850px" height="350px"></img> 
    <p>SAGEg loss: 0.01587</p>
</center>
<hr>
<center>
    <img src = "../../../media/motion/phase1/CP2/sagel.png" width="850px" height="350px"></img> 
    <p>SAGEl loss: 0.005061</p>
</center>
<hr>
<h3>EdgeConv</h3>
<center>
    <img src = "../../../media/motion/phase1/CP2/edge.png" width="850px" height="350px"></img> 
    <p>Edge loss: 0.005223 </p>
</center>
<hr>
<h3>Graph attention networks 
</h3>
<center>
    <img src = "../../../media/motion/phase1/CP2/attention.png" width="850px" height="350px"></img> 
    <p>GAT loss: 0.02380 </p>
</center>
<p> Edge and sageM was able to do the trick</p>
<hr>

<h2>Pushing limits</h2>
<p>Test limits and ability of network architecture</p>
<p>Specs:</p>
<ul>
  <li>Activation: Leaky relu </li>
  <li>Loss: MSE + MAE</li>
  <li>SAGEm: SAGEconv with mean aggregation</li>
  <li>Edge: Edgeconv</li>
  <b><li>Test: 3-32-16-4-1-3 [features]</li></b>
  <b><li>Narrow: 3-32-3</li></b>
  <b><li>Equal: 3-3-3-3-3</li></b>
</ul>
<center>
    <img src = "../../../media/motion/phase1/CP2/deeploss.png" width="600px" height="450px"></img> 
    <p>Loss</p>
</center>
<hr>
<h3>Equals (3-3-3-3-3)</h3>
<center>
    <img src = "../../../media/motion/phase1/CP2/equalloss.png" width="600px" height="450px"></img> 
    <p>Equal Loss</p>
</center>
<hr>
<center>
    <video width="850px" height="350px" autoplay = "autoplay" muted = "muted" loop = "loop">
        <source src="../../../media/motion/phase1/CP2/equaledge.mp4"  type="video/mp4">
    </video>
    <p>edge </p>
</center>
<hr>
<center>
    <video width="850px" height="350px" autoplay = "autoplay" muted = "muted" loop = "loop">
        <source src="../../../media/motion/phase1/CP2/equalsagem.mp4"  type="video/mp4">
    </video>
    <p>sagem</p>
</center>
<hr>
<h3>Narrows (3-32-3)</h3>
<center>
    <img src = "../../../media/motion/phase1/CP2/narrowloss.png" width="600px" height="450px"></img> 
    <p>Narrow Loss</p>
</center>
<hr>
<center>
    <img src = "../../../media/motion/phase1/CP2/narrowedge.png" width="850px" height="350px"></img> 
    <p>edge </p>
</center>
<hr>
<center>
    <img src = "../../../media/motion/phase1/CP2/narrowsagem.png" width="850px" height="350px"></img> 
    <p>sagem</p>
</center>
<hr>
<h3>Test (3-32-16-4-1-3)</h3>
<center>
    <img src = "../../../media/motion/phase1/CP2/testloss.png" width="600px" height="450px"></img> 
    <p>Test Loss</p>
</center>
<hr>
<center>
    <video width="850px" height="350px" autoplay = "autoplay" muted = "muted" loop = "loop">
        <source src="../../../media/motion/phase1/CP2/testedge.mp4"  type="video/mp4">
    </video>
    <p>edge </p>
</center>
<hr>
<center>
    <video width="850px" height="350px" autoplay = "autoplay" muted = "muted" loop = "loop">
        <source src="../../../media/motion/phase1/CP2/testsagem.mp4"  type="video/mp4">
    </video>
    <p>sagem</p>
</center>
<p> I think edge seems to be the best convolution.</p>
<hr>
<h2>Combinations with dense</h2>
<p>Test limits and ability of network architecture</p>
<p>Try max pool?</p>
<p>Specs:</p>
<ul>
  <li>Activation: Leaky relu </li>
  <li>Loss: MSE + MAE</li>
  <li>Conv: Edgeconv</li>
  <b><li>Identity: 3x588-1764,no activation</li></b>
  <b><li>Simple: 3x588-1x588-588-1764</li></b>
  <b><li>Try: 3x588-3x588-1x588-256-256-512-1024-1764</li></b>
  <b><li>Trypool: 3x588-3x588-1x588-294(maxpool)-256-512-1024-1764</li></b>
</ul>
<hr>
<center>
    <img src = "../../../media/motion/phase1/CP2/denseloss.png" width="600px" height="450px"></img> 
    <p>Loss</p>
</center>
<p>They all work so nothing to see here</p>
<hr>
<h2>Smaller we go!</h2>

<p>Specs:</p>
<ul>
    <li>Activation: Leaky relu </li>
    <li>Loss: MSE + MAE</li>
    <li>Conv: Edgeconv</li>
    <b><li>Try128: 3x588-3x588-1x588-128-256-512-1024-1764</li></b>
    <b><li>Try64: 3x588-3x588-1x588-64-128-256-512-1024-1764</li></b>
  </ul>
  <hr>
  <center>
    <img src = "../../../media/motion/phase1/CP2/condense.png" width="600px" height="450px"></img> 
    <p>Loss</p>
</center>

<p>Still works, nothing to see here, goes all the way down to 10 hidden units</p>
<hr>
<h2>Edge without self</h2>
<p> Idea here is that since edge conv actually takes the node feature as part of the convolution (so does SAGE), we are going to remove the 'self feature' part in edge conv and look at the results.</p>
<p>Specs:</p>
<ul>
    <li>Layers: 3-16-16-16-3</li>
    <li>Loss: MSE + MAE</li>
    <li>Conv: CustomEdgeconv</li>
    <b><li>custom: linear activation</li></b>
    <b><li>leakcustom: leakyrelu activation</li></b>
  </ul>
  <hr>
  <center>
    <img src = "../../../media/motion/phase1/CP2/customloss.png" width="600px" height="450px"></img> 
    <p>Loss</p>
</center>
<hr>
  <center>
      <video style="margin:-15%px" width="850px" height="350px" autoplay = "autoplay" muted = "muted" loop = "loop">
          <source src="../../../media/motion/phase1/CP2/custom1.mp4"  type="video/mp4">
      </video>
      <p>Custom1: loss:0.303077</p>
  </center>
  <hr>
  <center>
      <video width="850px" height="350px" autoplay = "autoplay" muted = "muted" loop = "loop">
          <source src="../../../media/motion/phase1/CP2/custom2.mp4"  type="video/mp4">
      </video>
      <p>Custom2: loss 0.31637</p>
  </center>
        <p>Both custom had similar results. They only learnt some cluster that minimizes loss no matter what.</p>
        <hr>
  <h2>Deeper messages</h2>

  <p>Specs:</p>
  <ul>
    <li>Normal Message Layer: 3-16 Act: linear</li>
    <b><li>Message Layer: 3-16-16-16 Act: leaky</li></b>
      <li>Loss: MSE + MAE</li>
      <li>Conv: CustomEdgeconv</li>
      <b><li>Custom:3-16-3</li></b>
      <b><li>deepCustom:3-16-16-16-3</li></b>
      <b><li>denseCustom: Conv(3-16-16-1)-588-588-1764 act:leakyrelu</b>
    </ul>

    <hr>
      <center>
          <video style="margin:-15%px" width="850px" height="350px" autoplay = "autoplay" muted = "muted" loop = "loop">
              <source src="../../../media/motion/phase1/CP2/customnet.mp4"  type="video/mp4">
          </video>
          <p>Custom net</p>
      </center>
      <hr>
      <center>
          <video width="850px" height="350px" autoplay = "autoplay" muted = "muted" loop = "loop">
              <source src="../../../media/motion/phase1/CP2/customdense.mp4"  type="video/mp4">
          </video>
          <p>Custom dense</p>
      </center>
      <p>Custom deep just died, we are now going to fix the input...</p>
      <p>Since none of the custom edge convs worked, I think it's safe to say edge conv and SAGE conv only worked because it took self features in and memorized it.</p>

</body>